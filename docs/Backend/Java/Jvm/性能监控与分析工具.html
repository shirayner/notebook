<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Backend/Java/Jvm/性能监控与分析工具">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">JVM性能监控与分析工具 | Ray</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://shirayner.github.io/notebook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://shirayner.github.io/notebook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://shirayner.github.io/notebook/docs/Backend/Java/Jvm/性能监控与分析工具"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="JVM性能监控与分析工具 | Ray"><meta data-rh="true" name="description" content="[toc]"><meta data-rh="true" property="og:description" content="[toc]"><link data-rh="true" rel="icon" href="/notebook/img/logo2.svg"><link data-rh="true" rel="canonical" href="https://shirayner.github.io/notebook/docs/Backend/Java/Jvm/性能监控与分析工具"><link data-rh="true" rel="alternate" href="https://shirayner.github.io/notebook/docs/Backend/Java/Jvm/性能监控与分析工具" hreflang="zh"><link data-rh="true" rel="alternate" href="https://shirayner.github.io/notebook/docs/Backend/Java/Jvm/性能监控与分析工具" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/notebook/blog/rss.xml" title="Ray RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notebook/blog/atom.xml" title="Ray Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/notebook/assets/css/styles.4d8ef97f.css">
<link rel="preload" href="/notebook/assets/js/runtime~main.0ad884d2.js" as="script">
<link rel="preload" href="/notebook/assets/js/main.c7ba66c6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notebook/"><div class="navbar__logo"><img src="/notebook/img/logo2.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/notebook/img/logo2.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Ray</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">后端</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/notebook/docs/category/Java">Java</a></li><li><a class="dropdown__link" href="/notebook/docs/category/数据库">数据库</a></li><li><a class="dropdown__link" href="/notebook/docs/category/Git">Git</a></li></ul></div><a class="navbar__item navbar__link" href="/notebook/docs/category/操作系统">操作系统</a><a class="navbar__item navbar__link" href="/notebook/docs/FrontEnd/index">前端</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/notebook/docs/Inbox">Inbox</a><a class="navbar__item navbar__link" href="/notebook/docs/tags">Tags</a><a href="https://github.com/shirayner" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notebook/docs/Backend/index">Backend</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/notebook/docs/category/java">Java</a><button aria-label="打开/收起侧边栏菜单「Java」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notebook/docs/category/java基础">Java基础</a><button aria-label="打开/收起侧边栏菜单「Java基础」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notebook/docs/category/java实用类库">Java实用类库</a><button aria-label="打开/收起侧边栏菜单「Java实用类库」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notebook/docs/category/java并发">Java并发</a><button aria-label="打开/收起侧边栏菜单「Java并发」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/notebook/docs/category/jvm">Jvm</a><button aria-label="打开/收起侧边栏菜单「Jvm」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/资源帖">资源帖</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/核心知识点图解">核心知识点图解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/编译器源码解析">编译器源码解析</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/性能监控与分析工具">性能监控与分析工具</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/notebook/docs/category/jvm生产排障">JVM生产排障</a><button aria-label="打开/收起侧边栏菜单「JVM生产排障」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/线上故障排查">线上故障排查</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/JVM性能优化指南">性能优化指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notebook/docs/Backend/Java/Jvm/JVM排障_01_CodeCache满导致应用性能降低">Code Cache满</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notebook/docs/category/数据库">数据库</a><button aria-label="打开/收起侧边栏菜单「数据库」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notebook/docs/category/ddd">DDD</a><button aria-label="打开/收起侧边栏菜单「DDD」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notebook/docs/category/architecture">Architecture</a><button aria-label="打开/收起侧边栏菜单「Architecture」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/notebook/docs/category/git">Git</a><button aria-label="打开/收起侧边栏菜单「Git」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/notebook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notebook/docs/category/java"><span itemprop="name">Java</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notebook/docs/category/jvm"><span itemprop="name">Jvm</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">性能监控与分析工具</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>JVM性能监控与分析工具</h1><p>[toc]</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="推荐阅读">推荐阅读<a href="#推荐阅读" class="hash-link" aria-label="推荐阅读的直接链接" title="推荐阅读的直接链接">​</a></h2><blockquote><ul><li><a href="https://gist.github.com/iamsixer/e7c1b1d459f52effd1c345870387a2c3" target="_blank" rel="noopener noreferrer">JVM 性能调优及监控工具.md</a></li><li><a href="https://www.cnblogs.com/chiangchou/p/jvm-4.html" target="_blank" rel="noopener noreferrer">JVM 性能调优（4） —— 性能调优工具</a></li><li><a href="https://mp.weixin.qq.com/s/iqlzfq_niGBBGeDz7iNTDg" target="_blank" rel="noopener noreferrer">JVM 性能监控与分析工具，我只用这几个！</a></li><li><a href="https://juejin.cn/post/6844903501269729288" target="_blank" rel="noopener noreferrer">jvm 调优工具分析指南</a></li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一jdk-命令行工具">一、JDK 命令行工具<a href="#一jdk-命令行工具" class="hash-link" aria-label="一、JDK 命令行工具的直接链接" title="一、JDK 命令行工具的直接链接">​</a></h2><blockquote><p>参考官方文档：<a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/toc.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/toc.html</a></p></blockquote><p>JDK 自带了很多性能监控工具，我们可以用这些工具来监测系统和排查内存性能问题。</p><p>命令行工具：</p><table><thead><tr><th align="left">名称</th><th align="left">主要作用</th></tr></thead><tbody><tr><td align="left">jps</td><td align="left">JVM 进程状态工具，查看系统上的 JVM 进程信息</td></tr><tr><td align="left">jstat</td><td align="left">JVM 统计信息监控工具，附加到一个 JVM 进程上收集和记录 JVM 的各种性能指标数据</td></tr><tr><td align="left">jinfo</td><td align="left">JVM 配置信息工具，查看 JVM 配置参数</td></tr><tr><td align="left">jmap</td><td align="left">JVM 堆内存分析工具，可以打印 JVM 进程对象直方图，类加载统计，以及做堆转储操作</td></tr><tr><td align="left">jhat</td><td align="left">JVM Heap Analysis Tool, 用于分析 heapdump 文件（它会建立一个 HTTP/HTML 服务器，让用户可以在浏览器上查看分析结果）</td></tr><tr><td align="left">jstack</td><td align="left">Stack Trace for Java, 显示虚拟机的线程快照</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1jps">1.jps<a href="#1jps" class="hash-link" aria-label="1.jps的直接链接" title="1.jps的直接链接">​</a></h3><blockquote><p>见官方文档：<a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jps.html#CHDCGECD" target="_blank" rel="noopener noreferrer">jps_java8</a></p></blockquote><p>JVM Process Status Tool （虚拟机进程状况工具）：</p><blockquote><p>查看本机当前登录用户的 java 进程，显示当前所有正在运行的虚拟机进程 ID、执行的主类名称、JVM 启动参数</p></blockquote><p>（1）命令格式</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jps </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> options </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> hostid </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>options：</p><table><thead><tr><th>option</th><th>description</th></tr></thead><tbody><tr><td>-q</td><td>只显示 pid，忽略 class 名称、jar 文件名和传递给 main 方法的参数</td></tr><tr><td>-m</td><td>输出传递给 main 方法的参数，如果是内嵌的 JVM 则输出为 null</td></tr><tr><td>-l</td><td>输出应用程序主类的完整包名，或者是应用程序 JAR 文件的完整路径</td></tr><tr><td>-v</td><td>输出传递给 JVM 的参数</td></tr><tr><td>-V</td><td>输出通过标记的文件传递给 JVM 的参数（.hotspotrc 文件，或者是通过参数-XX:Flags=<code>&lt;filename&gt;</code>指定的文件）</td></tr><tr><td>-J</td><td>用于传递 jvm 选项到由 javac 调用的 java 加载器中，例如，“-J-Xms48m”将把启动内存设置为 48M，使用-J 选项可以非常方便的向基于 Java 的开发的底层虚拟机应用程序传递参数。</td></tr></tbody></table><p>（2）示例</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ jps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15236</span><span class="token plain"> Jps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14966</span><span class="token plain"> Example1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jps -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15249</span><span class="token plain"> sun.tools.jps.Jps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14966</span><span class="token plain"> com.jaxer.jvm.egs.Example1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jps -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14966</span><span class="token plain"> Example1 -Dvisualvm.id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">44321340563858</span><span class="token plain"> -Xmx50m -Xms50m -XX:+PrintGCDetails -javaagent:/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">61849</span><span class="token plain">:/Applications/IntelliJ IDEA.app/Contents/bin -Dfile.encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">UTF-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15278</span><span class="token plain"> Jps -Dapplication.home</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/Library/Java/JavaVirtualMachines/jdk1.8.0_191.jdk/Contents/Home -Xms8m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2jstat">2.jstat<a href="#2jstat" class="hash-link" aria-label="2.jstat的直接链接" title="2.jstat的直接链接">​</a></h3><blockquote><p>见官方文档：<a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jstat.html" target="_blank" rel="noopener noreferrer">jstat_java8</a></p></blockquote><p>JVM Statistics Monitoring Tool （JVM 统计信息监控工具），Jstat 用于监控基于 HotSpot 的 JVM，对其堆的使用情况进行实时的命令行的统计，使用 jstat 我们可以对指定的 JVM 做如下监控：</p><blockquote><ul><li><p>类的加载及卸载情况</p></li><li><p>查看新生代、老生代及持久代的容量及使用情况</p></li><li><p>查看新生代、老生代及持久代的垃圾收集情况，包括垃圾回收的次数及垃圾回收所占用的时间</p></li><li><p>查看新生代中 Eden 区及 Survior 区中容量及分配情况等</p></li></ul></blockquote><p>（1）命令格式</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jstat </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> generalOption </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> outputOptions vmid </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> interval</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">s</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> count </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>generalOption</strong>：单个的常用的命令行选项，如-help, -options, 或 -version。</p><p><strong>outputOptions</strong>：一个或多个输出选项，由单个的 statOption 选项组成，可以和-t, -h, and -J 等选项配合使用。</p><p><strong>statOption</strong>：根据 jstat 统计的维度不同，可以使用如下表中的选项进行不同维度的统计，不同的操作系统支持的选项可能会不一样，可以通过-options 选项，查看不同操作系统所支持选项，如：</p><table><thead><tr><th align="left">Option</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#class_option" target="_blank" rel="noopener noreferrer">class</a></td><td align="left">用于查看类加载情况的统计</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#compiler_option" target="_blank" rel="noopener noreferrer">compiler</a></td><td align="left">用于查看 HotSpot 中即时编译器编译情况的统计</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gc_option" target="_blank" rel="noopener noreferrer">gc</a></td><td align="left">用于查看 JVM 中堆的垃圾收集情况的统计</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gccapacity_option" target="_blank" rel="noopener noreferrer">gccapacity</a></td><td align="left">用于查看新生代、老生代及持久代的存储容量情况</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gccause_option" target="_blank" rel="noopener noreferrer">gccause</a></td><td align="left">用于查看垃圾收集的统计情况（这个和-gcutil 选项一样），如果有发生垃圾收集，它还会显示最后一次及当前正在发生垃圾收集的原因。</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcnew_option" target="_blank" rel="noopener noreferrer">gcnew</a></td><td align="left">用于查看新生代垃圾收集的情况</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcnewcapacity_option" target="_blank" rel="noopener noreferrer">gcnewcapacity</a></td><td align="left">用于查看新生代的存储容量情况</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcold_option" target="_blank" rel="noopener noreferrer">gcold</a></td><td align="left">用于查看老生代及持久代发生 GC 的情况</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcoldcapacity_option" target="_blank" rel="noopener noreferrer">gcoldcapacity</a></td><td align="left">用于查看老生代的容量</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcpermcapacity_option" target="_blank" rel="noopener noreferrer">gcpermcapacity</a></td><td align="left">用于查看持久代的容量</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#gcutil_option" target="_blank" rel="noopener noreferrer">gcutil</a></td><td align="left">用于查看新生代、老生代及持代垃圾收集的情况</td></tr><tr><td align="left"><a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstat.html#printcompilation_option" target="_blank" rel="noopener noreferrer">printcompilation</a></td><td align="left">HotSpot 编译方法的统计</td></tr></tbody></table><p><strong>-h</strong> n：用于指定每隔几行就输出列头，如果不指定，默认是只在第一行出现列头。</p><p><strong>-J</strong> javaOption：用于将给定的<em>javaOption</em>传给 java 应用程序加载器，例如，“-J-Xms48m”将把启动内存设置为 48M。如果想查看可以传递哪些选项到应用程序加载器中，可以相看如下的文档：</p><blockquote><ul><li>Linux and Solaris：<a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/java.html" target="_blank" rel="noopener noreferrer">http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/java.html</a></li><li>Windows： <a href="http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/java.html" target="_blank" rel="noopener noreferrer">http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/java.html</a></li></ul></blockquote><p><strong>-t</strong> n ：用于在输出内容的第一列显示时间戳，这个时间戳代表的时 JVM 开始启动到现在的时间（注：在 IBM JDK5 中是没有这个选项的）</p><p><strong>vmid</strong> ： VM 的进程号，即当前运行的 java 进程号 pid。</p><p><strong>interval</strong> ：间隔时间，单位可以是秒或者毫秒，通过指定 s 或 ms 确定，默认单位为毫秒。</p><p><strong>count</strong>：打印次数，如果缺省则打印无数次。</p><p>（2）不同的统计维度（statOption）及输出说明</p><ul><li><strong>-class</strong>：类加载情况的统计</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Loaded</td><td align="left">加载了的类的数量</td></tr><tr><td align="left">Bytes</td><td align="left">加载了的类的大小，单为 Kb</td></tr><tr><td align="left">Unloaded</td><td align="left">卸载了的类的数量</td></tr><tr><td align="left">Bytes</td><td align="left">卸载了的类的大小，单为 Kb</td></tr><tr><td align="left">Time</td><td align="left">花在类的加载及卸载的时间</td></tr></tbody></table><ul><li><strong>-compiler</strong>：HotSpot 中即时编译器编译情况的统计</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Compiled</td><td align="left">编译任务执行的次数</td></tr><tr><td align="left">Failed</td><td align="left">编译任务执行失败的次数</td></tr><tr><td align="left">Invalid</td><td align="left">编译任务非法执行的次数</td></tr><tr><td align="left">Time</td><td align="left">执行编译花费的时间</td></tr><tr><td align="left">FailedType</td><td align="left">最后一次编译失败的编译类型</td></tr><tr><td align="left">FailedMethod</td><td align="left">最后一次编译失败的类名及方法名</td></tr></tbody></table><ul><li><strong>-gc</strong>：JVM 中堆的垃圾收集情况的统计</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">S0C</td><td align="left">新生代中 Survivor space 中 S0 当前容量的大小（KB）</td></tr><tr><td align="left">S1C</td><td align="left">新生代中 Survivor space 中 S1 当前容量的大小（KB）</td></tr><tr><td align="left">S0U</td><td align="left">新生代中 Survivor space 中 S0 容量使用的大小（KB）</td></tr><tr><td align="left">S1U</td><td align="left">新生代中 Survivor space 中 S1 容量使用的大小（KB）</td></tr><tr><td align="left">EC</td><td align="left">Eden space 当前容量的大小（KB）</td></tr><tr><td align="left">EU</td><td align="left">Eden space 容量使用的大小（KB）</td></tr><tr><td align="left">OC</td><td align="left">Old space 当前容量的大小（KB）</td></tr><tr><td align="left">OU</td><td align="left">Old space 使用容量的大小（KB）</td></tr><tr><td align="left">MC</td><td align="left">元空间当前容量大小(KB)</td></tr><tr><td align="left">MU</td><td align="left">元空间已使用容量的大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">YGCT</td><td align="left">从应用程序启动到采样时 Young GC 所用的时间(秒)</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr><tr><td align="left">FGCT</td><td align="left">从应用程序启动到采样时 Full GC 所用的时间(秒)</td></tr><tr><td align="left">GCT</td><td align="left">T 从应用程序启动到采样时用于垃圾回收的总时间(单位秒)，它的值等于 YGC+FGC</td></tr></tbody></table><ul><li><strong>-gccapacity</strong>：新生代、老生代及持久代的存储容量情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">NGCMN</td><td align="left">新生代的最小容量大小（KB）</td></tr><tr><td align="left">NGCMX</td><td align="left">新生代的最大容量大小（KB）</td></tr><tr><td align="left">NGC</td><td align="left">当前新生代的容量大小（KB）</td></tr><tr><td align="left">S0C</td><td align="left">当前新生代中 survivor space 0 的容量大小（KB）</td></tr><tr><td align="left">S1C</td><td align="left">当前新生代中 survivor space 1 的容量大小（KB）</td></tr><tr><td align="left">EC</td><td align="left">Eden space 当前容量的大小（KB）</td></tr><tr><td align="left">OGCMN</td><td align="left">老生代的最小容量大小（KB）</td></tr><tr><td align="left">OGCMX</td><td align="left">老生代的最大容量大小（KB）</td></tr><tr><td align="left">OGC</td><td align="left">当前老生代的容量大小（KB）</td></tr><tr><td align="left">OC</td><td align="left">当前老生代的空间容量大小（KB）</td></tr><tr><td align="left">PGCMN</td><td align="left">持久代的最小容量大小（KB）</td></tr><tr><td align="left">PGCMX</td><td align="left">持久代的最大容量大小（KB）</td></tr><tr><td align="left">PGC</td><td align="left">当前持久代的容量大小（KB）</td></tr><tr><td align="left">PC</td><td align="left">当前持久代的空间容量大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr></tbody></table><ul><li><p><strong>-gccause</strong> ：用于查看垃圾收集的统计情况，包括最近发生垃圾的原因</p><p>这个选项用于查看垃圾收集的统计情况（这个和-gcutil 选项一样），如果有发生垃圾收集，它还会显示最后一次及当前正在发生垃圾收集的原因，它比<strong>-gcutil</strong>会多出最后一次垃圾收集原因以及当前正在发生的垃圾收集的原因。</p></li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">LGCC</td><td align="left">最后一次垃圾收集的原因，可能为“unknown GCCause”、“System.gc()”等</td></tr><tr><td align="left">GCC</td><td align="left">当前垃圾收集的原因</td></tr></tbody></table><ul><li><strong>-gcnew</strong>：新生代垃圾收集的情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">S0C</td><td align="left">当前新生代中 survivor space 0 的容量大小（KB）</td></tr><tr><td align="left">S1C</td><td align="left">当前新生代中 survivor space 1 的容量大小（KB）</td></tr><tr><td align="left">S0U</td><td align="left">S0 已经使用的大小（KB）</td></tr><tr><td align="left">S1U</td><td align="left">S1 已经使用的大小（KB）</td></tr><tr><td align="left">TT</td><td align="left">Tenuring threshold，要了解这个参数，我们需要了解一点 Java 内存对象的结构，在 Sun JVM 中，（除了数组之外的）对象都有两个机器字（words）的头部。第一个字中包含这个对象的标示哈希码以及其他一些类似锁状态和等标识信息，第二个字中包含一个指向对象的类的引用，其中第二个字节就会被垃圾收集算法使用到。 在新生代中做垃圾收集的时候，每次复制一个对象后，将增加这个对象的收集计数，当一个对象在新生代中被复制了一定次数后，该算法即判定该对象是长周期的对象，把他移动到老生代，这个阈值叫着 tenuring threshold。这个阈值用于表示某个/些在执行批定次数 youngGC 后还活着的对象，即使此时新生的的 Survior 没有满，也同样被认为是长周期对象，将会被移到老生代中。</td></tr><tr><td align="left">MTT</td><td align="left">Maximum tenuring threshold，用于表示 TT 的最大值。</td></tr><tr><td align="left">DSS</td><td align="left">Desired survivor size (KB).可以参与这里：<a href="http://blog.csdn.net/yangjun2/article/details/6542357" target="_blank" rel="noopener noreferrer">http://blog.csdn.net/yangjun2/article/details/6542357</a></td></tr><tr><td align="left">EC</td><td align="left">Eden space 当前容量的大小（KB）</td></tr><tr><td align="left">EU</td><td align="left">Eden space 已经使用的大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">YGCT</td><td align="left">从应用程序启动到采样时 Young GC 所用的时间(单位秒)</td></tr></tbody></table><ul><li><strong>-gcnewcapacity</strong>：新生代的存储容量情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">NGCMN</td><td align="left">新生代的最小容量大小（KB）</td></tr><tr><td align="left">NGCMX</td><td align="left">新生代的最大容量大小（KB）</td></tr><tr><td align="left">NGC</td><td align="left">当前新生代的容量大小（KB）</td></tr><tr><td align="left">S0CMX</td><td align="left">新生代中 SO 的最大容量大小（KB）</td></tr><tr><td align="left">S0C</td><td align="left">当前新生代中 SO 的容量大小（KB）</td></tr><tr><td align="left">S1CMX</td><td align="left">新生代中 S1 的最大容量大小（KB）</td></tr><tr><td align="left">S1C</td><td align="left">当前新生代中 S1 的容量大小（KB）</td></tr><tr><td align="left">ECMX</td><td align="left">新生代中 Eden 的最大容量大小（KB）</td></tr><tr><td align="left">EC</td><td align="left">当前新生代中 Eden 的容量大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr></tbody></table><ul><li><strong>-gcold</strong>：老生代及持久代发生 GC 的情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">PC</td><td align="left">当前持久代容量的大小（KB）</td></tr><tr><td align="left">PU</td><td align="left">持久代使用容量的大小（KB）</td></tr><tr><td align="left">OC</td><td align="left">当前老年代容量的大小（KB）</td></tr><tr><td align="left">OU</td><td align="left">老年代使用容量的大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr><tr><td align="left">FGCT</td><td align="left">从应用程序启动到采样时 Full GC 所用的时间(单位秒)</td></tr><tr><td align="left">GCT</td><td align="left">从应用程序启动到采样时用于垃圾回收的总时间(单位秒)，它的值等于 YGC+FGC</td></tr></tbody></table><ul><li><strong>-gcoldcapacity</strong>： 老生代的存储容量情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">OGCMN</td><td align="left">老生代的最小容量大小（KB）</td></tr><tr><td align="left">OGCMX</td><td align="left">老生代的最大容量大小（KB）</td></tr><tr><td align="left">OGC</td><td align="left">当前老生代的容量大小（KB）</td></tr><tr><td align="left">OC</td><td align="left">当前新生代的空间容量大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr><tr><td align="left">FGCT</td><td align="left">从应用程序启动到采样时 Full GC 所用的时间(单位秒)</td></tr><tr><td align="left">GCT</td><td align="left">从应用程序启动到采样时用于垃圾回收的总时间(单位秒)，它的值等于 YGC+FGC</td></tr></tbody></table><ul><li><p><strong>-gcpermcapacity</strong>： 持久代的存储容量情况</p><p>从应用程序启动到采样时发生 Full GC 的次数</p></li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">PGCMN</td><td align="left">持久代的最小容量大小（KB）</td></tr><tr><td align="left">PGCMX</td><td align="left">持久代的最大容量大小（KB）</td></tr><tr><td align="left">PGC</td><td align="left">当前持久代的容量大小（KB）</td></tr><tr><td align="left">PC</td><td align="left">当前持久代的空间容量大小（KB）</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">FGC</td><td align="left"></td></tr><tr><td align="left">FGCT</td><td align="left">从应用程序启动到采样时 Full GC 所用的时间(单位秒)</td></tr><tr><td align="left">GCT</td><td align="left">从应用程序启动到采样时用于垃圾回收的总时间(单位秒)，它的值等于 YGC+FGC</td></tr></tbody></table><ul><li><strong>-gcutil</strong>：新生代、老生代及持代垃圾收集的情况</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">S0</td><td align="left">Heap 上的 Survivor space 0 区已使用空间的百分比</td></tr><tr><td align="left">S1</td><td align="left">Heap 上的 Survivor space 1 区已使用空间的百分比</td></tr><tr><td align="left">E</td><td align="left">Heap 上的 Eden space 区已使用空间的百分比</td></tr><tr><td align="left">O</td><td align="left">Heap 上的 Old space 区已使用空间的百分比</td></tr><tr><td align="left">M</td><td align="left">元空间利用率占空间当前容量的百分比。</td></tr><tr><td align="left">YGC</td><td align="left">从应用程序启动到采样时发生 Young GC 的次数</td></tr><tr><td align="left">YGCT</td><td align="left">从应用程序启动到采样时 Young GC 所用的时间(单位秒)</td></tr><tr><td align="left">FGC</td><td align="left">从应用程序启动到采样时发生 Full GC 的次数</td></tr><tr><td align="left">FGCT</td><td align="left">从应用程序启动到采样时 Full GC 所用的时间(单位秒)</td></tr><tr><td align="left">GCT</td><td align="left">从应用程序启动到采样时用于垃圾回收的总时间(单位秒)，它的值等于 YGC+FGC</td></tr></tbody></table><ul><li><strong>-printcompilation</strong>： HotSpot 编译方法的统计</li></ul><table><thead><tr><th align="left">列名</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">Compiled</td><td align="left">编译任务执行的次数</td></tr><tr><td align="left">Size</td><td align="left">方法的字节码所占的字节数</td></tr><tr><td align="left">Type</td><td align="left">编译类型</td></tr><tr><td align="left">Method</td><td align="left">指定确定被编译方法的类名及方法名，类名中使名“/”而不是“.”做为命名分隔符，方法名是被指定的类中的方法，这两个字段的格式是由 HotSpot 中的“-<strong>XX:+PrintComplation</strong>”选项确定的。</td></tr></tbody></table><p>（3）示例</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ jstat -gcutil </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">6.50</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">27.48</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">40.87</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">98.43</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">97.68</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">297</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.930</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.117</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 每个100秒打印堆中垃圾收集情况,打印 10 次</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jstat -gc </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">637.5</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">33414.7</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71446.8</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">301</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.969</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.156</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">637.5</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">33414.7</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71446.8</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">301</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.969</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.156</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">637.5</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">33414.7</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71446.8</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">301</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.969</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.156</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">637.5</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">33414.7</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71446.8</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">301</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.969</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.156</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">637.5</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">33416.7</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71446.8</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">301</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.969</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.156</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jstat -gc </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8704.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">601.2</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">70016.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">9267.2</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">174784.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">71445.0</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">85464.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84121.9</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10240.0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10001.9</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">300</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2.962</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0.187</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3.148</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3jinfo">3.jinfo<a href="#3jinfo" class="hash-link" aria-label="3.jinfo的直接链接" title="3.jinfo的直接链接">​</a></h3><blockquote><p>参见官网 <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jinfo.html#BCGEBFDD" target="_blank" rel="noopener noreferrer">jinfo_java8</a></p></blockquote><p>可查看和设置 JVM 配置信息。</p><p>（1）命令格式</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jinfo </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> option </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jinfo </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> option </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> executable core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jinfo </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> option </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> servier-id </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> remote-hostname-or-IP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>（2）示例</p><p>此命令用法简单，暂时只看几个示例</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 查看某个JVM参数的配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jinfo -flag MaxHeapSize </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-XX:MaxHeapSize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4278190080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 设置某个JVM参数的值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jinfo -flag </span><span class="token assign-left variable" style="color:#36acaa">MaxHeapSize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5278190080</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 查看全部JVM启动参数或系统变量的配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jinfo </span><span class="token number" style="color:#36acaa">8368</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4jmap">4.jmap<a href="#4jmap" class="hash-link" aria-label="4.jmap的直接链接" title="4.jmap的直接链接">​</a></h3><blockquote><p>参见官方文档 <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jmap.html#CEGCECJB" target="_blank" rel="noopener noreferrer">jmap_java8</a></p></blockquote><p>Java 内存映像工具，可以使用 jmap 查看内存中的对象数量及内存空间占用：</p><p>（1）命令格式</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jmap </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> options </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> pid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmap </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> options </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> executable core</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmap </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> options </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> pid </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> server-id@ </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> remote-hostname-or-IP</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>options：</p><blockquote><ul><li><code>&lt;no option&gt;</code>：如果不使用任何选项，则 jmap 命令将打印共享对象映射。 对于目标 JVM 中加载的每个共享库，将打印共享库文件的开始地址，映射大小和完整路径。</li><li><code>-heap</code>：打印堆的配置信息，堆各分代的内存情况</li><li><code>-histo[:live]</code>：打印堆的直方图。 对于每个 Java 类，都将打印对象数，以字节为单位的内存大小以及完全限定的类名。 JVM 内部类名称打印有星号（<!-- -->*<!-- -->）前缀。 如果指定了 live 子选项，则仅对活动对象进行计数。</li><li><code>-dump:[live,] format=b, file=filename</code>：将 Java 堆转储到 hprof 格式的二进制文件中。如果指定了可选的 live 子选项，则仅转储堆中的活动对象。要浏览堆转储，可以使用 jhat 命令来读取堆转储文件。</li></ul></blockquote><p>（2）示例</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">## 1.查看堆内存配置及占用情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jmap -heap </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Attaching to process ID </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain">, please wait</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: Hotspot VM version </span><span class="token number" style="color:#36acaa">25.71</span><span class="token plain">-b01-dcevmlight-26 does not match with SA version </span><span class="token number" style="color:#36acaa">25.181</span><span class="token plain">-b13. You may see unexpected results.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Debugger attached successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server compiler detected.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JVM version is </span><span class="token number" style="color:#36acaa">25.71</span><span class="token plain">-b01-dcevmlight-26</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using thread-local object allocation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mark Sweep Compact GC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Heap Configuration:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MinHeapFreeRatio         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MaxHeapFreeRatio         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MaxHeapSize              </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4278190080</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4080</span><span class="token plain">.0MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   NewSize                  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89456640</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">85</span><span class="token plain">.3125MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MaxNewSize               </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1426063360</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1360</span><span class="token plain">.0MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   OldSize                  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">178978816</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">170</span><span class="token plain">.6875MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   NewRatio                 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SurvivorRatio            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MetaspaceSize            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21807104</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token plain">.796875MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   CompressedClassSpaceSize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1073741824</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain">.0MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   MaxMetaspaceSize         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17592186044415</span><span class="token plain"> MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   G1HeapRegionSize         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.0MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Heap Usage:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New Generation </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Eden + </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> Survivor Space</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   capacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80609280</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">76</span><span class="token plain">.875MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   used     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65884512</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">62</span><span class="token plain">.832366943359375MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">free</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14724768</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">14</span><span class="token plain">.042633056640625MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">81.7331602515244</span><span class="token plain">% used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eden Space:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   capacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">71696384</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">68</span><span class="token plain">.375MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   used     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64944720</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">61</span><span class="token plain">.93611145019531MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">free</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6751664</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token plain">.4388885498046875MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">90.58297835494744</span><span class="token plain">% used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From Space:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   capacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8912896</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token plain">.5MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   used     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">939792</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.8962554931640625MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">free</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7973104</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token plain">.6037445068359375MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">10.544182272518382</span><span class="token plain">% used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To Space:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   capacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8912896</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token plain">.5MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   used     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.0MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">free</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8912896</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token plain">.5MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">% used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tenured generation:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   capacity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">178978816</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">170</span><span class="token plain">.6875MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   used     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57622840</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">54</span><span class="token plain">.95342254638672MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">free</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121355976</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">115</span><span class="token plain">.73407745361328MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">32.19534092794535</span><span class="token plain">% used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">29343</span><span class="token plain"> interned Strings occupying </span><span class="token number" style="color:#36acaa">3477648</span><span class="token plain"> bytes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 2.打印堆的直方图</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jmap -histo:live </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"> -20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> num     </span><span class="token comment" style="color:#999988;font-style:italic">#instances         #bytes  class name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">2332</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">27377816</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">86691</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">11906496</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">15551</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">2320904</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Ljava.lang.Object</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">84932</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">2038368</span><span class="token plain">  java.lang.String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">7070</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">1860064</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">I</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">15124</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">1686600</span><span class="token plain">  java.lang.Class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">42697</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">1366304</span><span class="token plain">  java.util.concurrent.ConcurrentHashMap</span><span class="token variable" style="color:#36acaa">$Node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">10507</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">924616</span><span class="token plain">  java.lang.reflect.Method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">19729</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">631328</span><span class="token plain">  java.util.HashMap</span><span class="token variable" style="color:#36acaa">$Node</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">5983</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">499968</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Ljava.util.HashMap</span><span class="token variable" style="color:#36acaa">$Node</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">11</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">11158</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">446320</span><span class="token plain">  java.util.LinkedHashMap</span><span class="token variable" style="color:#36acaa">$Entry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:         </span><span class="token number" style="color:#36acaa">24496</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">391936</span><span class="token plain">  java.lang.Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:           </span><span class="token number" style="color:#36acaa">404</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">362728</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Ljava.util.concurrent.ConcurrentHashMap</span><span class="token variable" style="color:#36acaa">$Node</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">5236</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">293216</span><span class="token plain">  java.util.LinkedHashMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">6539</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">209248</span><span class="token plain">  java.lang.ref.WeakReference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">9579</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">207760</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Ljava.lang.Class</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:          </span><span class="token number" style="color:#36acaa">3442</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">165216</span><span class="token plain">  java.util.HashMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">## 3.导出堆转储快照</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jmap -dump:live,format</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">b,file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">./dump.hprof </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dumping heap to C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">ray</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">mess</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">dump.hprof </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Heap dump </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5jhat">5.jhat<a href="#5jhat" class="hash-link" aria-label="5.jhat的直接链接" title="5.jhat的直接链接">​</a></h3><p>分析 jmap 生成的快照文件</p><p>（1）示例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ jhat dump.hprof</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Reading from dump.hprof</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> created Wed Jan </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:57:27 CST </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Snapshot read, resolving</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resolving </span><span class="token number" style="color:#36acaa">521526</span><span class="token plain"> objects</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chasing references, </span><span class="token function" style="color:#d73a49">expect</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">104</span><span class="token plain"> dots</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eliminating duplicate references</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Snapshot resolved.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Started HTTP server on port </span><span class="token number" style="color:#36acaa">7000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server is ready.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Server 启动后，在浏览器打开 <a href="http://localhost:7000/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%A6%82%E4%B8%8B%E4%BF%A1%E6%81%AF" target="_blank" rel="noopener noreferrer">http://localhost:7000/，可以看到如下信息</a>：</p><p><img loading="lazy" alt="图片" src="/notebook/assets/images/640-c96714b0b04519031d5dd1cc7a32d4ea.png" width="1080" height="641" class="img_ev3q"></p><blockquote><p>实际工作中，一般不会直接使用 jhat 命令来分析 dump 文件，主要原因：</p><ol><li>一般不会在部署应用程序的服务器上直接分析 dump 文件（分析工作一般比较耗时，而且消耗硬件资源，在其他机器上进行时则没必要受到命令行工具的限制）；</li><li>jhat 分析功能相对简陋，VisualVM 等更工具功能强大。</li></ol></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6jstack">6.jstack<a href="#6jstack" class="hash-link" aria-label="6.jstack的直接链接" title="6.jstack的直接链接">​</a></h3><p>参见官方文档 <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jstack.html#BABGJDIF" target="_blank" rel="noopener noreferrer">jstack_java8</a></p><p>Java 堆栈跟踪工具</p><blockquote><ul><li>jstack (Stack Trace for Java) 命令用于生成虚拟机当前时刻的线程快照（一般称为 threaddump 或 javacore 文件）</li><li>线程快照就是当前虚拟机内每一条线程正在执行的方法堆栈的集合，生成堆栈快照的主要目的是定位线程出现长时间停顿的原因，如线程死锁、死循环、请求外部资源导致的长时间等待等都是导致线程长时间停顿的常见原因</li></ul></blockquote><p>示例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ jstack -l </span><span class="token number" style="color:#36acaa">8368</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"> -20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-01-20 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:34:14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Full thread dump Dynamic Code Evolution </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-Bit Server VM </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">25.71</span><span class="token plain">-b01-dcevmlight-26 mixed mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Keep-Alive-Timer&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#517 daemon prio=8 os_prio=1 tid=0x000000001b453000 nid=0x2fb0 waiting on condition [0x0000000044a0e000]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   java.lang.Thread.State: TIMED_WAITING </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sleeping</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.Thread.sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Native Method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at sun.net.www.http.KeepAliveCache.run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">KeepAliveCache.java:172</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.Thread.run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Thread.java:748</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Locked ownable synchronizers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;dredis-clusterFactory-dispatcher-thread-8&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#157 daemon prio=5 os_prio=0 tid=0x000000001b450000 nid=0x2210 waiting on condition [0x0000000029c0e000]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   java.lang.Thread.State: WAITING </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parking</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at sun.misc.Unsafe.park</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Native Method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - parking to </span><span class="token function" style="color:#d73a49">wait</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">0x0000000718e6f60</span><span class="token operator file-descriptor important" style="color:#393A34">8</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a java.util.concurrent.locks.AbstractQueuedSynchronizer</span><span class="token variable" style="color:#36acaa">$ConditionObject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.util.concurrent.locks.LockSupport.park</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LockSupport.java:175</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.util.concurrent.locks.AbstractQueuedSynchronizer</span><span class="token variable" style="color:#36acaa">$ConditionObject</span><span class="token plain">.await</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AbstractQueuedSynchronizer.java:2039</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.util.concurrent.LinkedBlockingQueue.take</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LinkedBlockingQueue.java:442</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.util.concurrent.ThreadPoolExecutor.getTask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ThreadPoolExecutor.java:1074</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二linux-命令行工具">二、Linux 命令行工具<a href="#二linux-命令行工具" class="hash-link" aria-label="二、Linux 命令行工具的直接链接" title="二、Linux 命令行工具的直接链接">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三可视化工具">三、可视化工具<a href="#三可视化工具" class="hash-link" aria-label="三、可视化工具的直接链接" title="三、可视化工具的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-jvisualvm">1. jvisualvm<a href="#1-jvisualvm" class="hash-link" aria-label="1. jvisualvm的直接链接" title="1. jvisualvm的直接链接">​</a></h3><p>VisualVM 是一个 JVM 监控工具，也是一体化 Java 故障排除工具，能够监控线程、内存、CPU、GC 等情况，支持堆转储快照分析，并且可以根据需要安装不同的插件以扩展相应的功能。</p><blockquote><ul><li><p>jvisualvm 是 JDK 自带的命令，虽然后面独立发展了。这两种方式都可以使用。</p></li><li><p>VisualVM 链接：<a href="https://visualvm.github.io/" target="_blank" rel="noopener noreferrer">https://visualvm.github.io/</a></p></li></ul></blockquote><p>（1）概述、监视、线程页</p><p>打开 VisualVM 后，会在左侧栏列出本地，正在运行的进程的 pid 和名称，选择一个后会打开应用程序的概述页面：</p><p><img loading="lazy" alt="image-20210120200614678" src="/notebook/assets/images/image-20210120200614678-a1aa6a202f8ab2046ce55f5cfdbeb84b.png" width="1501" height="518" class="img_ev3q"></p><p>在监视页面能看到 CPU、内存、线程、类的使用情况</p><p><img loading="lazy" alt="image-20210120200802306" src="/notebook/assets/images/image-20210120200802306-f1fff34251c51ead0d9ddd3dbf3e7287.png" width="951" height="713" class="img_ev3q"></p><p>在线程页面，可以看到所有线程的运行情况</p><p><img loading="lazy" alt="image-20210120200948723" src="/notebook/assets/images/image-20210120200948723-722fbc04356c67e8209bdb2c7c91636d.png" width="952" height="682" class="img_ev3q"></p><p>（2）安装插件来扩展功能</p><p>通过 <code>工具</code> -&gt; <code>插件</code> -&gt; <code>可用插件</code> -&gt; <code>勾选目标插件</code> -&gt; <code>安装</code> 的方式来安装需要的插件，可扩展 VisualVM 的功能，比如安装 VisualVM GC 之后，Tab 页会出现 Visual GC 页面，打开后可显示各分代的的内存使用情况：</p><p><img loading="lazy" alt="image-20210120201514501" src="/notebook/assets/images/image-20210120201514501-f59744e4ca81882a701560613dd7ed2b.png" width="1016" height="705" class="img_ev3q"></p><p>（3）dump 文件分析</p><p>通过 <code>文件</code> -&gt; <code>装入</code> -&gt; <code>然后选择前面通过 jmap 导出的dump文件</code> ，即可对 dump 文件进行分析</p><p>在概要页可查看 dump 文件的基本信息、jvm 参数与系统变量、线程运行情况</p><p><img loading="lazy" alt="image-20210120201903406" src="/notebook/assets/images/image-20210120201903406-e34d95eefc9207d01807c22bd1a8a8fd.png" width="935" height="571" class="img_ev3q"></p><p>在类的 Tab 页，可以查看类的相关信息</p><p><img loading="lazy" alt="image-20210120202455490" src="/notebook/assets/images/image-20210120202455490-b55307d8efff497e94a046e5f94f632a.png" width="832" height="712" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2mat">2.MAT<a href="#2mat" class="hash-link" aria-label="2.MAT的直接链接" title="2.MAT的直接链接">​</a></h3><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四arthas">四、Arthas<a href="#四arthas" class="hash-link" aria-label="四、Arthas的直接链接" title="四、Arthas的直接链接">​</a></h2><blockquote><ul><li>官方文档：<a href="https://alibaba.github.io/arthas/" target="_blank" rel="noopener noreferrer">https://alibaba.github.io/arthas/</a></li><li>阿里云在线教程：<a href="https://start.aliyun.com/handson-lab/#!category=arthas" target="_blank" rel="noopener noreferrer">https://start.aliyun.com/handson-lab/#%21category=arthas</a></li></ul></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1下载-arthas">1.下载 Arthas<a href="#1下载-arthas" class="hash-link" aria-label="1.下载 Arthas的直接链接" title="1.下载 Arthas的直接链接">​</a></h3><p>打开 Athas Github 的版本发布页，选择 <code>arthas-bin.zip</code>进行下载</p><blockquote><p><a href="https://github.com/alibaba/arthas/releases" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/arthas/releases</a></p></blockquote><p><img loading="lazy" alt="image-20210121142308097" src="/notebook/assets/images/image-20210121142308097-778492eb7fc1d80b0093842ba6823f89.png" width="576" height="349" class="img_ev3q"></p><p>解压后目录如下：</p><p><img loading="lazy" alt="image-20210121142643513" src="/notebook/assets/images/image-20210121142643513-084a3feaef5fad35c4a1e1665c3202d8.png" width="590" height="336" class="img_ev3q"></p><p>注意：</p><blockquote><p>也可通过 curl 直接下载 <code>arthas-demo.jar</code>、<code>arthas-boot.jar</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -O https://arthas.aliyun.com/arthas-demo.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -O https://arthas.aliyun.com/arthas-boot.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2启动-demo">2.启动 Demo<a href="#2启动-demo" class="hash-link" aria-label="2.启动 Demo的直接链接" title="2.启动 Demo的直接链接">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -jar arthas-demo.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>arthas-demo</code>是一个简单的程序，每隔一秒生成一个随机数，再执行质因数分解，并打印出分解结果。</p><p>源码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">demo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">ArrayList</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">List</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Random</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">concurrent</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">TimeUnit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MathGame</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">Random</span><span class="token plain"> random </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> illegalArgumentCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">InterruptedException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">MathGame</span><span class="token plain"> game </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">MathGame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            game</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">TimeUnit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">SECONDS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">InterruptedException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> number </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">nextInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">10000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> primeFactors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">primeFactors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> primeFactors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;illegalArgumentCount:%3d, &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> illegalArgumentCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> primeFactors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">StringBuffer</span><span class="token plain"> sb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">StringBuffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;=&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> factor </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> primeFactors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">charAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token char">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">deleteCharAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">primeFactors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            illegalArgumentCount</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">IllegalArgumentException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;number is: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> number </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;, need &gt;= 2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                number </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> number </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3启动-arthas">3.启动 Arthas<a href="#3启动-arthas" class="hash-link" aria-label="3.启动 Arthas的直接链接" title="3.启动 Arthas的直接链接">​</a></h3><p>启动 Arthas</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ $ java -jar arthas-boot.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">35542</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">71560</span><span class="token plain"> arthas-demo.jar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接着输入 2 然后回车，arthas 就会 attach 到目标进程上，并输出日志：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Try to attach process </span><span class="token number" style="color:#36acaa">71560</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Attach process </span><span class="token number" style="color:#36acaa">71560</span><span class="token plain"> success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">INFO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> arthas-client connect </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 </span><span class="token number" style="color:#36acaa">3658</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ,---.  ,------. ,--------.,--.  ,--.  ,---.   ,---.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /  O  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  .--. </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">--.  .--</span><span class="token string" style="color:#e3116c">&#x27;|  &#x27;</span><span class="token plain">--</span><span class="token string" style="color:#e3116c">&#x27;  | /  O  \ &#x27;</span><span class="token plain">   .-</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">|  .-.  ||  &#x27;</span><span class="token plain">--</span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  .--.  </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">  .-.  </span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">-.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">.-</span><span class="token string" style="color:#e3116c">&#x27;    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">`--&#x27;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">--&#x27;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">--</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token plain">--</span><span class="token string" style="color:#e3116c">&#x27;   `--&#x27;</span><span class="token plain">   </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">--&#x27;  </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">--</span><span class="token string" style="color:#e3116c">&#x27;`--&#x27;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">--&#x27;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">-----&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiki: https://arthas.aliyun.com/doc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version: </span><span class="token number" style="color:#36acaa">3.0</span><span class="token plain">.5.20181127201536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pid: </span><span class="token number" style="color:#36acaa">71560</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">time: </span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:16:24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4dashboard">4.dashboard<a href="#4dashboard" class="hash-link" aria-label="4.dashboard的直接链接" title="4.dashboard的直接链接">​</a></h3><p>输入<a href="https://arthas.aliyun.com/doc/dashboard.html" target="_blank" rel="noopener noreferrer">dashboard</a>，按<code>回车/enter</code>，会展示当前进程的信息，按<code>ctrl+c</code>可以中断执行。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ dashboard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ID     NAME                   GROUP          PRIORI STATE  %CPU    TIME   INTERRU DAEMON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">17</span><span class="token plain">     pool-2-thread-1        system         </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">      WAITIN </span><span class="token number" style="color:#36acaa">67</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">27</span><span class="token plain">     Timer-for-arthas-dashb system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     RUNNAB </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">11</span><span class="token plain">     AsyncAppender-Worker-a system         </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">      WAITIN </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9</span><span class="token plain">      Attach Listener        system         </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">      RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">      Finalizer              system         </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">      WAITIN </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">      Reference Handler      system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     WAITIN </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">      Signal Dispatcher      system         </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">      RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">26</span><span class="token plain">     as-command-execute-dae system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     TIMED_ </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">13</span><span class="token plain">     job-timeout            system         </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">      TIMED_ </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">      main                   main           </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">      TIMED_ </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14</span><span class="token plain">     nioEventLoopGroup-2-1  system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">18</span><span class="token plain">     nioEventLoopGroup-2-2  system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">23</span><span class="token plain">     nioEventLoopGroup-2-3  system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15</span><span class="token plain">     nioEventLoopGroup-3-1  system         </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">     RUNNAB </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">       </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">:0    </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain">   </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory             used   total max    usage GC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">heap               32M    155M  1820M  </span><span class="token number" style="color:#36acaa">1.77</span><span class="token plain">% gc.ps_scavenge.count  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ps_eden_space      14M    65M   672M   </span><span class="token number" style="color:#36acaa">2.21</span><span class="token plain">% gc.ps_scavenge.time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m </span><span class="token number" style="color:#36acaa">166</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ps_survivor_space  4M     5M    5M           s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ps_old_gen         12M    85M   1365M  </span><span class="token number" style="color:#36acaa">0.91</span><span class="token plain">% gc.ps_marksweep.count </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nonheap            20M    23M   -1           gc.ps_marksweep.time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">code_cache         3M     5M    240M   </span><span class="token number" style="color:#36acaa">1.32</span><span class="token plain">% ms</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.name                Mac OS X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os.version             </span><span class="token number" style="color:#36acaa">10.13</span><span class="token plain">.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.version           </span><span class="token number" style="color:#36acaa">1.8</span><span class="token plain">.0_162</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.home              /Library/Java/JavaVir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       tualMachines/jdk1.8.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       _162.jdk/Contents/Hom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       e/jre</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5thread">5.thread<a href="#5thread" class="hash-link" aria-label="5.thread的直接链接" title="5.thread的直接链接">​</a></h3><p><code>thread 1</code>会打印线程 ID 1 的栈，通常是 main 函数的线程。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ thread </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;main(&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    at demo.MathGame.main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MathGame.java:17</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="6jad">6.jad<a href="#6jad" class="hash-link" aria-label="6.jad的直接链接" title="6.jad的直接链接">​</a></h3><p>通过 jad 可反编译 Class</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ jad demo.MathGame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ClassLoader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-sun.misc.Launcher</span><span class="token variable" style="color:#36acaa">$AppClassLoader</span><span class="token plain">@3d4eac69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  +-sun.misc.Launcher</span><span class="token variable" style="color:#36acaa">$ExtClassLoader</span><span class="token plain">@66350f69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Location:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/arthas-demo.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Decompiled with CFR 0_132.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">package demo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.io.PrintStream</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.util.ArrayList</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.util.Iterator</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.util.List</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.util.Random</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> java.util.concurrent.TimeUnit</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MathGame </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static Random random </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new Random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int illegalArgumentCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws InterruptedException </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MathGame game </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new MathGame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            game.run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TimeUnit.</span><span class="token environment constant" style="color:#36acaa">SECONDS</span><span class="token plain">.sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1L</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> throws InterruptedException </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int number </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> random.nextInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> primeFactors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> this.primeFactors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MathGame.print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number, primeFactors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Exception e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">String.format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;illegalArgumentCount:%3d, &quot;</span><span class="token plain">, this.illegalArgumentCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> + e.getMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">))</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int number, List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> primeFactors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StringBuffer sb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new StringBuffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> + number + </span><span class="token string" style="color:#e3116c">&quot;=&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> iterator </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> primeFactors.iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iterator.hasNext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">))</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int factor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> iterator.next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sb.append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">factor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">.append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb.charAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb.length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sb.deleteCharAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb.length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public List</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> primeFactors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">int number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ++this.illegalArgumentCount</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new IllegalArgumentException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;number is: &quot;</span><span class="token plain"> + number + </span><span class="token string" style="color:#e3116c">&quot;, need &gt;= 2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new ArrayList</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Integer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number % i </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                result.add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                number /</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token builtin class-name">continue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ++i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin class-name">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Affect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">row-cnt:1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> cost </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">970</span><span class="token plain"> ms.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="7watch">7.watch<a href="#7watch" class="hash-link" aria-label="7.watch的直接链接" title="7.watch的直接链接">​</a></h3><p>通过<a href="https://arthas.aliyun.com/doc/watch.html" target="_blank" rel="noopener noreferrer">watch</a>命令来查看<code>demo.MathGame#primeFactors</code>函数的返回值：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">watch</span><span class="token plain"> demo.MathGame primeFactors returnObj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Press Ctrl+C to abort.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Affect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class-cnt:1 , method-cnt:1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> cost </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token plain"> ms.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:30</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.715367ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:31</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.185203ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:32</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">19</span><span class="token plain">.012416ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@ArrayList</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">47</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2675531</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:33</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">.311395ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@ArrayList</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">317</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">503</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">887</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:34</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain">.136007ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@ArrayList</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">717593</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ts</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2018</span><span class="token plain">-11-28 </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:22:35</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cost</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">29</span><span class="token plain">.969732ms</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">result</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">@ArrayList</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Integer</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">7651739</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="8退出-arthas">8.退出 arthas<a href="#8退出-arthas" class="hash-link" aria-label="8.退出 arthas的直接链接" title="8.退出 arthas的直接链接">​</a></h3><p>如果只是退出当前的连接，可以用<code>quit</code>或者<code>exit</code>命令。Attach 到目标进程上的 arthas 还会继续运行，端口会保持开放，下次连接时可以直接连接上。</p><p>如果想完全退出 arthas，可以执行<code>stop</code>命令。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/notebook/docs/tags/jvm">JVM</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/shirayner/notebook/tree/master/docs/03-Backend/01-Java/04-Jvm/03_性能监控与分析工具.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/notebook/docs/Backend/Java/Jvm/编译器源码解析"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">编译器源码解析</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notebook/docs/category/jvm生产排障"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">JVM生产排障</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#推荐阅读" class="table-of-contents__link toc-highlight">推荐阅读</a></li><li><a href="#一jdk-命令行工具" class="table-of-contents__link toc-highlight">一、JDK 命令行工具</a><ul><li><a href="#1jps" class="table-of-contents__link toc-highlight">1.jps</a></li><li><a href="#2jstat" class="table-of-contents__link toc-highlight">2.jstat</a></li><li><a href="#3jinfo" class="table-of-contents__link toc-highlight">3.jinfo</a></li><li><a href="#4jmap" class="table-of-contents__link toc-highlight">4.jmap</a></li><li><a href="#5jhat" class="table-of-contents__link toc-highlight">5.jhat</a></li><li><a href="#6jstack" class="table-of-contents__link toc-highlight">6.jstack</a></li></ul></li><li><a href="#二linux-命令行工具" class="table-of-contents__link toc-highlight">二、Linux 命令行工具</a></li><li><a href="#三可视化工具" class="table-of-contents__link toc-highlight">三、可视化工具</a><ul><li><a href="#1-jvisualvm" class="table-of-contents__link toc-highlight">1. jvisualvm</a></li><li><a href="#2mat" class="table-of-contents__link toc-highlight">2.MAT</a></li></ul></li><li><a href="#四arthas" class="table-of-contents__link toc-highlight">四、Arthas</a><ul><li><a href="#1下载-arthas" class="table-of-contents__link toc-highlight">1.下载 Arthas</a></li><li><a href="#2启动-demo" class="table-of-contents__link toc-highlight">2.启动 Demo</a></li><li><a href="#3启动-arthas" class="table-of-contents__link toc-highlight">3.启动 Arthas</a></li><li><a href="#4dashboard" class="table-of-contents__link toc-highlight">4.dashboard</a></li><li><a href="#5thread" class="table-of-contents__link toc-highlight">5.thread</a></li><li><a href="#6jad" class="table-of-contents__link toc-highlight">6.jad</a></li><li><a href="#7watch" class="table-of-contents__link toc-highlight">7.watch</a></li><li><a href="#8退出-arthas" class="table-of-contents__link toc-highlight">8.退出 arthas</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notebook/docs/about">关于</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notebook/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Ray, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/notebook/assets/js/runtime~main.0ad884d2.js"></script>
<script src="/notebook/assets/js/main.c7ba66c6.js"></script>
</body>
</html>