---
sidebar_label: 堆内存溢出生产排查
tags:
  - JVM
---

# JVM堆内存溢出生产排查

## 推荐阅读

> - [JVM 内存分析工具 MAT 的深度讲解与实践——入门篇](https://juejin.cn/post/6908665391136899079)
> - [1. MAT从入门到精通](https://tracyliu1.github.io/gitbook/Performance/25.MAT%E4%BD%BF%E7%94%A8.html)

## 一、排查过程

### 1. 下载dump文件

这一步可以使用你们公司提供的平台或者工具直接下载，就不细说，这里我们说一下登录到对应的机器上去下载的方法。

（1）登录机器，然后使用jps命令查看进程号。

```bash
# 列出所有正在运行的Java进程和它们的PID（进程标识符）
jps -l
```

（2）使用jmap命令生成dump文件

```bash
jmap -dump:live,format=b,file=heapdump.bin <pid>
```

在这个命令中，我们使用了jmap命令来生成堆转储文件（dump文件）。这个命令需要提供进程的PID。生成的文件会保存在指定的路径下。

### 2.使用MAT分析dump文件

下载及安装：

> - [MAT(Memory Analyzer Tool)下载和安装](https://www.cnblogs.com/zwh0910/p/15774590.html)

我们可以使用Eclipse Memory Analyzer Tool（MAT）这样的工具来分析dump文件：

> - 打开MAT工具，选择Open Heap Dump，找到我们生成的dump文件，点击Open。
>
> - 稍等片刻，MAT会分析dump文件，并显示出一个概览窗口。在这个窗口中，我们可以看到最大的对象、垃圾收集器等信息。
>
>   3.3 在左侧栏中，我们可以看到各个class实例的数量。如果某个class的实例数量过多，那么它可能是造成内存溢出的原因之一。
>
>   3.4 在左侧栏中，我们还可以看到内存泄漏报告。这些报告会告诉我们哪些对象被保留了下来，导致了内存泄漏。
